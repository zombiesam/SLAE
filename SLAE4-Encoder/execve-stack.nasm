; Filename: execve-stack.nasm
; Author:  Vivek Ramachandran
; Website:  http://securitytube.net
; Training: http://securitytube-training.com 
;
;
; Purpose: 

global _start			

section .text
_start:

	; PUSH the first null dword 
	xor eax, eax
	push eax

	; PUSH ////bin/bash (12) 

	push 0x68736162
	push 0x2f6e6962
	push 0x2f2f2f2f

	; PUSH //bin/sh (8 bytes) 

;	push 0x68732f2f
;	push 0x6e69622f

	; PUSH //bin/ls 

;	push 0x736c2f2f
;	push 0x6e69622f

	; move stack pointer into ebx
	mov ebx, esp

	; push zero onto stack
	; move stack pointer into edx (pointer to NULL)
	push eax
	mov edx, esp

	; push ebx content onto stack
	; move esp into ecx
	push ebx
	mov ecx, esp


	mov al, 11
	int 0x80



